webpackJsonp([0],{Cdx3:function(t,e,n){var i=n("sB3e"),a=n("lktj");n("uqUo")("keys",function(){return function(t){return a(i(t))}})},Jy52:function(t,e){},fZjL:function(t,e,n){t.exports={default:n("jFbC"),__esModule:!0}},jFbC:function(t,e,n){n("Cdx3"),t.exports=n("FeBl").Object.keys},raP7:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("fZjL"),a=n.n(i),s=[{title:"名称",dataIndex:"DisplayName",align:"center",width:"50%"},{title:"描述",dataIndex:"Desc",align:"center",width:"50%"}],o=[{title:"DisplayName",dataIndex:"DisplayName",align:"center",width:"25%"},{title:"TechnicalAddress",dataIndex:"TechnicalAddress",align:"center",width:"25%"},{title:"Location",dataIndex:"Location",align:"center",width:"25%"},{title:"TPType",dataIndex:"TPType",align:"center",width:"50%"}],c={name:"forthwith-monitor",data:function(){return{data:[],menu:[],eqType:"",eqName:"",pointInfo:[],pointVal:[],columns:s,columns2:o,dataSource:[],dataSource2:[],popWarning:[],imgUrl:n("dxoW"),commStatus:{Value:"",Time:""},loading:!1,collapsed:!1,rootSubmenuKeys:[],openKeys:[]}},mounted:function(){this.init()},methods:{popConfirm:function(t){console.log(t)},popCancel:function(t){console.log(t)},init:function(){var t=this;this.getEquipments().then(function(e){t.data=e,t.menu=t.unique(e),t.eqType=t.menu[0],t.changeMenu(t.eqType)})},unique:function(t){for(var e=this,n=[],i={},a=function(a){if(i[t[a].Code])n.forEach(function(e){e.Code==t[a].Code&&e.Equipments.push(t[a])});else{var s={Code:t[a].Code,DisplayName:t[a].Description.replace(/\d+/g,""),Equipments:[]};s.Equipments.push(t[a]),n.push(s),e.rootSubmenuKeys.push(t[a].Code),i[t[a].Code]=!0}},s=0;s<t.length;s++)a(s);return this.openKeys.push(this.rootSubmenuKeys[0]),n},changeMenu:function(t){this.eqType=t,this.eqName=this.eqType.Equipments[0].Name,this.changeTab(this.eqName)},changeTab:function(t){this.eqName=t,this.initPoint()},initPoint:function(){var t=this;this.getPointInformations(this.eqName).then(function(e){console.log(e),0==e.length&&t.$message.error("暂无数据");var n=[];t.pointInfo=e,t.pointInfo.forEach(function(t){n.push({Id:t.EntityId})}),t.getPointValues(n).then(function(e){console.log(e),t.pointVal=e,t.initPage()})})},initPage:function(){var t=this,e=[];this.popWarning=[];for(var n=0;n<this.pointInfo.length;n++)if(this.pointInfo[n]){var i=this.pointInfo[n].DisplayName;-1==i.indexOf("只读")&&-1==i.indexOf("读构建")&&function(){var s="";if(t.pointVal[n])if(t.pointVal[n].st.ib)s="坏点";else{var o=t.pointVal[n].t;if("String"==o?s=t.pointVal[n].s:"Long"==o&&(s=t.pointVal[n].l),""!=t.pointInfo[n].MeaningOfValue){var c=JSON.parse(t.pointInfo[n].MeaningOfValue);a()(c).forEach(function(t){t==s&&(s=c[t])})}""!=t.pointInfo[n].UnitOfMeasurement&&(s+=t.pointInfo[n].UnitOfMeasurement),t.pointVal[n].st.ia&&t.popWarning.push({DisplayName:i,Desc:s}),"通信状态"==i&&(t.commStatus.Value=s,t.commStatus.Time=t.$common.timestampToTime(t.pointVal[n].ti))}else"通信状态"==i&&(t.commStatus.Value="暂无数据",t.commStatus.Time="暂无数据");e.push({DisplayName:i,Desc:s})}()}this.dataSource=e},toggleCollapsed:function(){this.collapsed=!this.collapsed},onOpenChange:function(t){var e=this,n=t.find(function(t){return-1===e.openKeys.indexOf(t)});-1===this.rootSubmenuKeys.indexOf(n)?this.openKeys=t:this.openKeys=n?[n]:[]},getEquipments:function(){return this.$http.get(this.$api.monitorEquipments).then(function(t){if(t.data.value)return t.data.value})},getPointInformations:function(t){var e="/config/pointinformations?&$filter=indexof(Name,'"+t+"') ge 0";return this.$http.get(e).then(function(t){if(t.data.value)return t.data.value})},getPointValues:function(t){return this.$http.post("/point/api/getpoint/getpointvalues",t).then(function(t){if(t.data)return t.data})},getPointValue:function(t){return this.$http.post("/point/api/getpoint/getpointvalue",t).then(function(t){if(t.data)return t.data})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"forthwith-monitor"},[i("div",{staticClass:"control-module"},[i("div",{staticClass:"select-menu"},[i("a-menu",{attrs:{mode:"inline",theme:"dark",defaultSelectedKeys:[t.menu[0].Code]}},[t._l(t.menu,function(e){return[i("a-menu-item",{key:e.Code,on:{click:function(n){return t.changeMenu(e)}}},[i("span",[t._v(t._s(e.DisplayName))])])]})],2)],1),t._v(" "),i("div",{staticClass:"show-area"},[i("div",{staticClass:"select-taps"},[[i("a-tabs",{attrs:{type:"card"},on:{change:t.changeTab}},[t._l(t.eqType.Equipments,function(t){return[i("a-tab-pane",{key:t.Name,attrs:{tab:t.Description}})]}),t._v(" "),i("a",{staticStyle:{"margin-right":"20px"},attrs:{slot:"tabBarExtraContent"},slot:"tabBarExtraContent"},[i("a-badge",{attrs:{dot:"",count:t.popWarning.length}},[i("a-popover",{attrs:{title:"告警提示",trigger:"click",placement:"leftBottom"}},[i("template",{slot:"content"},t._l(t.popWarning,function(e){return i("p",[i("span",[t._v(t._s(e.DisplayName))]),t._v("\n                      ：\n                      "),i("span",{},[t._v(t._s(e.Desc))])])}),0),t._v(" "),i("a-button",{attrs:{type:"primary"}},[i("a-icon",{attrs:{type:"notification"}})],1)],2)],1)],1)],2)]],2),t._v(" "),i("div",{staticClass:"select-container"},[i("a-carousel",{attrs:{arrows:""},scopedSlots:t._u([{key:"prevArrow",fn:function(t){return i("div",{staticClass:"custom-slick-arrow",staticStyle:{left:"10px",zIndex:"1"}},[i("a-icon",{attrs:{type:"left-circle"}})],1)}},{key:"nextArrow",fn:function(t){return i("div",{staticClass:"custom-slick-arrow",staticStyle:{right:"10px"}},[i("a-icon",{attrs:{type:"right-circle"}})],1)}}])},[t._v(" "),t._v(" "),i("div",[i("div",{staticClass:"select-container-bg"}),t._v(" "),i("div",{staticClass:"select-container-module",attrs:{id:"basicInfo"}},[i("div",{staticClass:"boxes"},[i("div",{staticClass:"equipment"},[i("img",{attrs:{src:t.imgUrl,alt:""}})])]),t._v(" "),i("div",{staticClass:"boxes"},[i("div",{staticClass:"pointInfo"},[i("a-table",{staticClass:"flipInX",attrs:{columns:t.columns,dataSource:t.dataSource,showHeader:!1,pagination:!1,loading:t.loading}})],1)])])]),t._v(" "),i("div",[i("div",{staticClass:"select-container-bg"}),t._v(" "),i("div",{staticClass:"select-container-module",attrs:{id:"KPI"}},[i("div",{staticClass:"boxes"},[i("img",{staticClass:"boxes-bg",attrs:{src:n("W2do"),alt:""}}),t._v(" "),i("div",{staticClass:"boxes-cont"},[i("div",{staticClass:"borde"},[t._v("能量流图")]),t._v(" "),i("div",{staticClass:"pointStatus-ti"},[t._v("\n                    2019年12月19日 09:31:31\n\n                  ")]),t._v(" "),i("div",{staticClass:"energy"},[i("img",{attrs:{src:n("FBg+"),alt:""}})])])]),t._v(" "),i("div",{staticClass:"boxes"},[i("img",{staticClass:"boxes-bg",attrs:{src:n("W2do"),alt:""}}),t._v(" "),i("div",{staticClass:"boxes-cont"},[i("div",{staticClass:"borde"},[t._v("通信状态")]),t._v(" "),i("div",{staticClass:"pointStatus-ti"},[t._v("\n                    "+t._s(t.commStatus.Time)+"\n\n                  ")]),t._v(" "),i("div",{staticClass:"electricity"},[i("div",{staticClass:"status"},[t._v("\n                      "+t._s(t.commStatus.Value)+"\n                    ")])])])]),t._v(" "),i("div",{staticClass:"boxes",staticStyle:{width:"100%"}},[i("img",{staticClass:"boxes-bg",staticStyle:{width:"95%",left:"2.5%"},attrs:{src:n("W2do"),alt:""}}),t._v(" "),i("div",{staticClass:"boxes-cont"},[i("div",{staticClass:"borde"},[t._v("电池后备时间")]),t._v(" "),i("div",{staticClass:"pointStatus-ti"},[t._v("\n                    2019年12月19日 09:31:31\n\n                  ")]),t._v(" "),i("div",{staticClass:"battery"},[i("a-table",{attrs:{columns:t.columns2,dataSource:t.dataSource2,showHeader:!0,pagination:!1,loading:t.loading}})],1)])])])])])],1)])])])},staticRenderFns:[]};var l=n("VU/8")(c,r,!1,function(t){n("Jy52")},"data-v-c49a0864",null);e.default=l.exports},uqUo:function(t,e,n){var i=n("kM2E"),a=n("FeBl"),s=n("S82l");t.exports=function(t,e){var n=(a.Object||{})[t]||Object[t],o={};o[t]=e(n),i(i.S+i.F*s(function(){n(1)}),"Object",o)}}});
//# sourceMappingURL=0.65275761855ac0a2962a.js.map