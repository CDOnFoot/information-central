webpackJsonp([11],{"8t4E":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=a("woOf"),i=a.n(d),o=[{title:"门禁卡号",dataIndex:"Encoded",align:"center",width:40},{title:"持卡人",dataIndex:"DisplayName",align:"center",width:40},{title:"有效期",dataIndex:"DisplayExpire",align:"center",width:80},{title:"门禁卡类型",dataIndex:"TimeSheetType",align:"center",width:40},{title:"描述",dataIndex:"Description",align:"center",width:40},{title:"状态",dataIndex:"Enable",align:"center",width:40,scopedSlots:{customRender:"enable"}},{title:"操 作",align:"center",width:40,scopedSlots:{customRender:"operation"}}],n=[{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!1,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色86",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!1,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]}],l={name:"card-manage",components:{AFormItem:a("SWcn").a},data:function(){var e=this;return{modal:"",cardForm:{},isShowModal:!1,okButton:"",modalTitle:"",confirmLoading:!1,columns:o,expandAllRows:!0,enableEdit:!1,modalForm:{Encoded:"",DisplayName:"",DisplayExpire:"",TimeSheetType:"",Description:"",Enable:""},pagination:{current:1,defaultCurrent:1,defaultPageSize:20,total:0,size:"large",showQuickJumper:!0,onChange:function(t){return e.changePage(t)}},loading:!1,badgeCode:"",cardholder:"",tableData:[],tableList:[]}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"advanced_search"})},created:function(){},beforeMount:function(){},mounted:function(){this.initTable()},methods:{initTable:function(){var e=this;e.loading=!0,e.form.validateFields(function(t,a){t||e.$http.get(e.$api.getCards).then(function(t){e.tableData=t.data.value,0==e.tableData.length&&(e.tableData=n),e.tableData.forEach(function(t,a){t.Encoded=t.Badges[0].Encoded,t.DisplayName=t.Role.DisplayName,t.Expire=t.Badges[0].Expire,t.DisplayExpire=e.$common.timestampToTime(t.Badges[0].Expire),t.TimeSheetType=t.Badges[0].TimeSheetType,t.Enable=t.Badges[0].Enable,e.tableList.push(t)}),console.log(e.tableList),e.pagination.total=e.tableList.length,e.loading=!1})})},searchFor:function(){var e=this;e.tableList=e.tableData,e.tableList=e.tableList.filter(function(t){return(t.Encoded+"").indexOf(e.badgeCode)>-1}),e.tableList=e.tableList.filter(function(t){return(t.DisplayName+"").indexOf(e.cardholder)>-1}),e.pagination.total=e.tableList.length,e.pagination.current=1},changePage:function(e){this.pagination.current=e},addCard:function(){this.modalForm=i()({},{}),this.modalTitle="添加门禁卡",this.okButton="保存",this.enableEdit=!1,this.isShowModal=!0},checkCard:function(e){this.modalForm=i()({},e),this.modalTitle="查看门禁卡",this.modalForm.Enable=!0===this.modalForm.Enable?"Enable":"Disable",this.okButton="确定",this.enableEdit=!0,this.isShowModal=!0},editCard:function(e){this.modalForm=i()({},e),this.modalTitle="编辑门禁卡",this.modalForm.Enable=!0===this.modalForm.Enable?"Enable":"Disable",this.okButton="保存",this.enableEdit=!1,this.isShowModal=!0},deleteCard:function(e){var t=this;t.modal=t.Modal.confirm({title:"删除门禁卡",cancelText:"取消",centered:!0,closable:!1,content:"此操作将在列表删除此条数据，是否继续？",okType:"warning",onOk:function(e){var a={EntityId:t.modalForm.EntityId};t.$http.post(t.$api.deleteUser,a).then(function(e){if(200!==e.status)return!1;"success"===e.data&&t.$info({title:"完成",content:"已删除此条数据！",onOk:function(){t.modal.destroy()}}),t.modal.destroy()})},onCancel:function(e){t.modal.destroy()}})},handleOk:function(e){var t=this,a=null;if(t.confirmLoading=!0,"添加门禁卡"===t.modalTitle){var d=t.modalForm.Encoded,i=t.modalForm.DisplayName,o=(t.modalForm.Expire,t.modalForm.TimeSheetType),n=t.modalForm.Description;t.modalForm.Enable;a={Modified:new Date,IsDeleted:!1,Actived:new Date,Expired:new Date,Type:o,FirstName:"",LastName:i,Description:n,IsBlocked:!1,Code:d,Role:"",Department:""},console.log(a),t.$http.post(t.$api.getCards,a).then(function(e){console.log(e),"success"===e.data?t.$info({title:"提示",content:"添加成功！",onOk:function(){t.isShowModal=!1}}):t.$info({title:"错误",content:"发生了一些错误："+e.data.Message,onOk:function(){t.isShowModal=!1}}),t.confirmLoading=!1})}else"查看门禁卡"===t.modalTitle?(t.isShowModal=!1,t.confirmLoading=!1):"编辑门禁卡"===t.modalTitle&&(console.log(t.modalForm),t.$http.post(t.$api.updateUsers,a).then(function(e){"success"===e.data?t.$info({title:"提示",content:"修改成功！",onOk:function(){t.isShowModal=!1}}):t.$info({title:"错误",content:"发生了一些错误："+e.data.Message,onOk:function(){t.isShowModal=!1}}),t.confirmLoading=!1}))},closeModal:function(e){this.confirmLoading=!1,this.isShowModal=!1},changeTime:function(e,t){console.log(e,t)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-manage"},[a("div",{staticClass:"search-condition"},[a("a-form",{attrs:{layout:"inline",form:e.cardForm}},[a("a-form-item",{attrs:{label:"门禁卡号"}},[a("a-input",{attrs:{placeholder:"门禁卡号"},model:{value:e.badgeCode,callback:function(t){e.badgeCode=t},expression:"badgeCode"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"持卡人"}},[a("a-input",{attrs:{placeholder:"持卡人"},model:{value:e.cardholder,callback:function(t){e.cardholder=t},expression:"cardholder"}})],1),e._v(" "),a("a-form-item",[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.searchFor}},[e._v("搜索")])],1),e._v(" "),a("a-form-item",[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.addCard}},[e._v("添加")])],1)],1)],1),e._v(" "),a("div",{staticClass:"modal"},[a("a-modal",{attrs:{width:"800px",visible:e.isShowModal,okText:e.okButton,centered:"",destroyOnClose:"",title:e.modalTitle,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.closeModal}},[a("div",{staticClass:"form-in-modal"},[a("a-form",{attrs:{form:e.modalForm}},[a("div",{staticClass:"modal-form"},[a("div",{staticClass:"modal-form-one",staticStyle:{width:"50%"}},[a("a-form-item",{attrs:{label:"门禁卡号","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Encoded,callback:function(t){e.$set(e.modalForm,"Encoded",t)},expression:"modalForm.Encoded"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"门禁卡类型","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.TimeSheetType,callback:function(t){e.$set(e.modalForm,"TimeSheetType",t)},expression:"modalForm.TimeSheetType"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"状态","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-select",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Enable,callback:function(t){e.$set(e.modalForm,"Enable",t)},expression:"modalForm.Enable"}},[a("a-select-option",{attrs:{value:"Enable"}},[e._v("启用")]),e._v(" "),a("a-select-option",{attrs:{value:"Disable"}},[e._v("未启用")])],1)],1)],1),e._v(" "),a("div",{staticClass:"modal-form-two",staticStyle:{width:"50%"}},[a("a-form-item",{attrs:{label:"持卡人","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.DisplayName,callback:function(t){e.$set(e.modalForm,"DisplayName",t)},expression:"modalForm.DisplayName"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"有效期","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.DisplayExpire,callback:function(t){e.$set(e.modalForm,"DisplayExpire",t)},expression:"modalForm.DisplayExpire"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"描述","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Description,callback:function(t){e.$set(e.modalForm,"Description",t)},expression:"modalForm.Description"}})],1)],1)])])],1)])],1),e._v(" "),a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:e.columns,dataSource:e.tableList,pagination:e.pagination,loading:e.loading,defaultExpandAllRows:e.expandAllRows,size:"small"},scopedSlots:e._u([{key:"enable",fn:function(t){return[e._v("\n        "+e._s(t)+"\n        ")]}},{key:"operation",fn:function(t,d){return[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkCard(d)}}},[e._v("查看")]),e._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.editCard(d)}}},[e._v("编辑")]),e._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteCard(d)}}},[e._v("删除")])]}}])})],1)])},staticRenderFns:[]};var r=a("VU/8")(l,s,!1,function(e){a("TLqJ")},"data-v-3b529074",null);t.default=r.exports},TLqJ:function(e,t){}});
//# sourceMappingURL=11.cda6356ca5868fa3b3ed.js.map