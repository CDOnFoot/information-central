webpackJsonp([12],{bH2L:function(t,a){},s8IG:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=e("woOf"),i=e.n(o),n=[{title:"登录名",dataIndex:"Name",align:"center",width:"10%"},{title:"姓 名",dataIndex:"DisplayName",align:"center",width:30},{title:"固 话",dataIndex:"Tel",align:"center",width:"10%"},{title:"手机号",dataIndex:"PhoneNumber",align:"center",width:"12%"},{title:"创建时间",dataIndex:"Created",align:"center",width:"12%"},{title:"更新时间",dataIndex:"Updated",align:"center",width:"12%"},{title:"过期时间",dataIndex:"Expired",align:"center",width:"12%"},{title:"状 态",dataIndex:"Status",align:"center",width:"5%"},{title:"操 作",align:"center",width:"18%",scopedSlots:{customRender:"operation"}}],l={name:"user-manage",components:{AFormItem:e("SWcn").a},data:function(){var t=this;return{modal:"",searchName:"",okButton:"保存",isShowModal:!1,confirmLoading:!1,column:n,expandAllRows:!0,enableEdit:!1,enableEditTime:!0,pagination:{current:0,defaultCurrent:1,defaultPageSize:18,total:0,size:"large",onChange:function(a){return t.changePage(a)}},modalTitle:"",loading:!1,modalForm:{Name:"",DisplayName:"",EntityId:"",Status:"",Created:"",Tel:"",PhoneNumber:"",Expired:"",Updated:""},tableList:[],tableContainer:[]}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"advanced_search"})},created:function(){},beforeMount:function(){},mounted:function(){this.initTable()},methods:{initTable:function(){for(var t=this,a=this,e=this.tableList.length,o=0;o<=e;o++)this.tableList.pop();this.loading=!0,this.form.validateFields(function(e,o){e||t.$http.get(a.$api.getUsers).then(function(t){a.pagination.total=t.data.value.length;var e=t.data.value;a.pagination.defaultPageSize;e.forEach(function(t,e){t.Created=a.$common.timestampToTime(t.Created),t.Updated=a.$common.timestampToTime(t.Updated),t.Expired=a.$common.timestampToTime(t.Expired),t.Status="Enable"===t.Status?"启用":"未启用"}),a.tableList=e,a.loading=!1})})},changePage:function(t){""!==this.searchName&&this.handleConditionSearch(t),this.handleTableChange(t)},handleConditionSearch:function(t){for(var a=this,e=this,o=this.tableList.length,i=0;i<=o;i++)this.tableList.pop();this.loading=!0,this.$http.get(e.$api.getUsers).then(function(t){var o=[];t.data.value.forEach(function(t,i){t.Created=a.$common.timestampToTime(t.Created),t.Updated=a.$common.timestampToTime(t.Updated),t.Expired=a.$common.timestampToTime(t.Expired),t.Status="Enable"===t.Status?"启用":"停用",t.Name.includes(e.searchName)&&o.push(t)}),e.tableList=o,e.loading=!1})},searchFor:function(t){var a=this,e=this;this.tableList=[],t.preventDefault(),this.pagination.current=1,this.loading=!0,this.form.validateFields(function(t,o){t||a.$http.get(e.$api.getUsers).then(function(t){var o=[];t.data.value.forEach(function(t,i){t.Created=a.$common.timestampToTime(t.Created),t.Updated=a.$common.timestampToTime(t.Updated),t.Expired=a.$common.timestampToTime(t.Expired),t.Status="Enable"===t.Status?"启用":"未启用",""!==e.searchName?t.Name.includes(e.searchName)&&o.push(t):o.push(t)}),e.tableList=o,e.tableContainer=o,e.pagination.total=e.tableList.length,e.loading=!1})})},handleTableList:function(t){var a=this,e=this.searchName;t.some(function(t){""===e&&void 0===e&&null===e||(t.Name===e&&a.tableList.push(t),a.tableList=t)})},handleTableChange:function(t){for(var a=this,e=(this.pagination.defaultPageSize,this.tableList.length),o=0;o<=e;o++)a.tableList.pop();this.loading=!0,this.pagination.current=t,this.$http.get(a.$api.getUsers+"&$skip="+(t-1)*a.pagination.defaultPageSize+"&$top="+a.pagination.defaultPageSize).then(function(t){try{var e=[],o=t.data.value;o.forEach(function(t,o){t.Created=a.$common.timestampToTime(t.Created),t.Updated=a.$common.timestampToTime(t.Updated),t.Expired=a.$common.timestampToTime(t.Expired),t.Status="Enable"===t.Status?"启用":"未启用",e.push(t)}),a.tableList=o}catch(t){console.log('there are some data have "null":'+t)}a.loading=!1})},checkUser:function(t){var a=i()({},t);this.modalForm=i()({},a),this.modalForm.Status="启用"===this.modalForm.Status?"Enable":"Disable",this.okButton="确定",this.modalTitle="查看用户信息",this.enableEdit=!0,this.isShowModal=!0},editUser:function(t){this.modalForm=i()({},t),this.modalForm.Status="启用"===this.modalForm.Status?"Enable":"Disable",this.enableEdit=!1,this.isShowModal=!0,this.okButton="保存",this.modalTitle="编辑用户信息"},deleteUser:function(t){var a=this;this.modalForm=i()({},t);this.modal=this.Modal.confirm({title:"删除用户信息",cancelText:"取消",centered:!0,closable:!1,content:"此操作将在列表删除此条数据，是否继续？",okType:"warning",onOk:function(t){var e={EntityId:a.modalForm.EntityId};a.$http.post(a.$api.deleteUser,e).then(function(t){if(200!==t.status)return!1;"success"===t.data&&a.$info({title:"完成",content:"已删除当前用户！",onOk:function(){a.modal.destroy()}}),a.modal.destroy()})},onCancel:function(t){a.modal.destroy()}})},handleOk:function(t){var a=this,e=null;this.confirmLoading=!0;var o=this.modalTitle;"添加用户信息"===o?(e={EntityId:0,Name:a.modalForm.Name,DisplayName:a.modalForm.DisplayName},this.$http.post(a.$api.addUsers,e).then(function(t){console.log(t),"success"===t.data?a.$info({title:"提示",content:"添加成功！",onOk:function(){a.isShowModal=!1}}):"登录名称重复"===t.data.Message?a.$info({title:"错误",content:"登录名已经存在，请重新输入",onOk:function(){}}):a.$info({title:"错误",content:"发生了一些错误："+t.status+"，请检查您的输入信息",onOk:function(){}}),a.confirmLoading=!1})):"查看用户信息"===o?(this.isShowModal=!1,this.confirmLoading=!1):"编辑用户信息"===o&&(e={EntityId:a.modalForm.EntityId,Name:a.modalForm.Name,DisplayName:a.modalForm.DisplayName,Tel:a.modalForm.Tel,PhoneNumber:a.modalForm.PhoneNumber,GroupId:[],RoleIds:[2028,2019]},this.$http.post(a.$api.updateUsers,e).then(function(t){"success"===t.data&&("Enable"===a.modalForm.Status?a.$http.post(a.$api.restartUser,{EntityId:a.modalForm.EntityId}).then(function(t){console.log(t)}).catch(function(t){console.log(t),a.$info({title:"提示",content:"出现了一些错误："+t,onOk:function(){}})}):a.$http.post(a.$api.lockUser,{EntityId:a.modalForm.EntityId}).then(function(t){}),a.$info({title:"提示",content:"修改成功！",onOk:function(){a.isShowModal=!1}})),a.confirmLoading=!1}))},closeModal:function(t){this.confirmLoading=!1,this.isShowModal=!1},addUser:function(){this.modalForm=i()({},{}),this.modalTitle="添加用户信息",this.enableEdit=!1,this.isShowModal=!0}}},s={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"search-condition"},[e("a-form",{attrs:{layout:"inline",form:t.form},on:{submit:t.searchFor}},[e("a-form-item",{attrs:{label:"姓名："}},[e("a-input",{attrs:{placeholder:"登录名"},model:{value:t.searchName,callback:function(a){t.searchName=a},expression:"searchName"}})],1),t._v(" "),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"search","html-type":"submit"}},[t._v("搜索")])],1),t._v(" "),e("a-form-item",[e("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:t.addUser}},[t._v("添加")])],1)],1)],1),t._v(" "),e("div",{staticClass:"modal"},[e("a-modal",{attrs:{visible:t.isShowModal,okText:t.okButton,centered:"",destroyOnClose:"",title:t.modalTitle,"confirm-loading":t.confirmLoading},on:{ok:t.handleOk,cancel:t.closeModal}},[e("div",{staticClass:"form-in-modal"},[e("a-form",{attrs:{form:t.modalForm}},[e("div",{staticClass:"modal-form"},[e("div",{staticClass:"modal-form-one"},[e("a-form-item",{attrs:{label:"登录名","label-col":{span:7},"wrapper-col":{span:14},required:""}},[e("a-input",{attrs:{disabled:t.enableEdit},model:{value:t.modalForm.Name,callback:function(a){t.$set(t.modalForm,"Name",a)},expression:"modalForm.Name"}})],1),t._v(" "),e("a-form-item",{attrs:{label:"姓名","label-col":{span:7},"wrapper-col":{span:14}}},[e("a-input",{attrs:{disabled:t.enableEdit},model:{value:t.modalForm.DisplayName,callback:function(a){t.$set(t.modalForm,"DisplayName",a)},expression:"modalForm.DisplayName"}})],1),t._v(" "),e("a-form-item",{attrs:{label:"状态","label-col":{span:7},"wrapper-col":{span:14}}},[e("a-select",{attrs:{disabled:t.enableEdit},model:{value:t.modalForm.Status,callback:function(a){t.$set(t.modalForm,"Status",a)},expression:"modalForm.Status"}},[e("a-select-option",{attrs:{value:"Enable"}},[t._v("启用")]),t._v(" "),e("a-select-option",{attrs:{value:"Disable"}},[t._v("未启用")])],1)],1)],1),t._v(" "),e("div",{staticClass:"modal-form-two"},[e("a-form-item",{attrs:{label:"固话","label-col":{span:7},"wrapper-col":{span:14}}},[e("a-input",{attrs:{disabled:t.enableEdit},model:{value:t.modalForm.Tel,callback:function(a){t.$set(t.modalForm,"Tel",a)},expression:"modalForm.Tel"}})],1),t._v(" "),e("a-form-item",{attrs:{label:"手机号","label-col":{span:7},"wrapper-col":{span:14}}},[e("a-input",{attrs:{disabled:t.enableEdit},model:{value:t.modalForm.PhoneNumber,callback:function(a){t.$set(t.modalForm,"PhoneNumber",a)},expression:"modalForm.PhoneNumber"}})],1)],1)])])],1)])],1),t._v(" "),e("div",{staticClass:"table"},[e("a-table",{attrs:{columns:t.column,loading:t.loading,dataSource:t.tableList,pagination:t.pagination,defaultExpandAllRows:t.expandAllRows,size:"small"},scopedSlots:t._u([{key:"operation",fn:function(a,o){return[e("a-button",{attrs:{type:"dashed",ghost:""},on:{click:function(a){return t.checkUser(o)}}},[t._v("查看")]),t._v(" "),e("a-button",{attrs:{type:"dashed",ghost:""},on:{click:function(a){return t.editUser(o)}}},[t._v("编辑")]),t._v(" "),e("a-button",{attrs:{type:"dashed",ghost:""},on:{click:function(a){return t.deleteUser(o)}}},[t._v("删除")])]}}])})],1)])},staticRenderFns:[]};var d=e("VU/8")(l,s,!1,function(t){e("bH2L")},"data-v-15ff04bc",null);a.default=d.exports}});
//# sourceMappingURL=12.72168177b7bd04fc1451.js.map