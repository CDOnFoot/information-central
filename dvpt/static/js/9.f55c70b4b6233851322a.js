webpackJsonp([9],{"6Xs4":function(e,t){},"8t4E":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=a("woOf"),i=a.n(d),o=[{EntityId:4,Modified:"2019-11-18T10:42:37.233+08:00",IsDeleted:!1,Actived:"2019-11-18T10:42:43.417+08:00",Expired:"2019-11-18T10:42:43.417+08:00",LastName:"胡六七",FirstName:"",Code:"12131233",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5315,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"125412541254",KeypadID:11167,BadgeTechnologyID:0,Created:"2019-11-27T17:25:36.487+08:00",Modified:"2019-11-27T17:25:17.03+08:00",Expire:"2019-11-27T17:25:36.487+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:8,Modified:"2019-10-09T10:53:55.193+08:00",IsDeleted:!1,Actived:"2019-10-09T10:57:15.11+08:00",Expired:"2020-10-09T10:57:13.893+08:00",LastName:"张四",FirstName:"",Code:"123",Type:"Job",Description:"123",IsBlocked:!1,Role:{EntityId:1,Name:"角色1",DisplayName:"测试角色1",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-10-13T17:40:59.533+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:1406,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"00123",KeypadID:111111,BadgeTechnologyID:0,Created:"2019-10-16T11:14:17.513+08:00",Modified:"2019-10-16T11:14:34.9+08:00",Expire:"2019-10-16T11:14:17.513+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:34,Modified:"2019-09-27T18:37:25.6+08:00",IsDeleted:!1,Actived:"2019-09-27T18:37:25.6+08:00",Expired:"2020-09-27T18:37:24.797+08:00",LastName:"张王",FirstName:"",Code:"10990",Type:"Job",Description:"1455",IsBlocked:!1,Role:{EntityId:4,Name:"角色4",DisplayName:"测试角色4",Created:"2018-10-25T10:12:58+08:00",Updated:"2018-10-25T10:12:58+08:00"},Department:{EntityId:2,Name:"BASC",DisplayName:"机电中心",Created:"2018-10-25T10:12:58+08:00",Updated:"2018-10-25T10:12:58+08:00"},Badges:[{EntityId:42,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"1111",KeypadID:222222,BadgeTechnologyID:0,Created:"2019-09-29T10:22:22.467+08:00",Modified:"2019-09-29T10:19:26.053+08:00",Expire:"2019-09-30T08:00:00+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:42,Modified:"2019-10-09T10:56:37.277+08:00",IsDeleted:!1,Actived:"2019-10-09T10:56:37.277+08:00",Expired:"2020-10-09T10:56:35.94+08:00",LastName:"张三",FirstName:"",Code:"001",Type:"Job",Description:"",IsBlocked:!1,Role:{EntityId:4,Name:"角色4",DisplayName:"测试角色4",Created:"2018-10-25T10:12:58+08:00",Updated:"2018-10-25T10:12:58+08:00"},Department:{EntityId:2,Name:"BASC",DisplayName:"机电中心",Created:"2018-10-25T10:12:58+08:00",Updated:"2018-10-25T10:12:58+08:00"},Badges:[{EntityId:91,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"1111111111",KeypadID:111111,BadgeTechnologyID:0,Created:"2019-10-09T10:59:13.133+08:00",Modified:"2019-10-09T10:59:13.133+08:00",Expire:"2020-10-31T08:00:00+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:46,Modified:"2019-11-21T14:59:41.093+08:00",IsDeleted:!1,Actived:"2019-11-21T14:59:51.11+08:00",Expired:"2019-11-21T14:59:51.11+08:00",LastName:"胡四",FirstName:"",Code:"101025",Type:"Job",Description:"",IsBlocked:!0,Role:{EntityId:1,Name:"角色1",DisplayName:"测试角色1",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-10-13T17:40:59.533+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:4311,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"138549",KeypadID:111111,BadgeTechnologyID:0,Created:"2019-11-28T09:47:41.06+08:00",Modified:"2019-11-28T09:47:24.727+08:00",Expire:"2019-11-28T09:47:41.06+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:647,Modified:"2019-11-26T14:36:01.787+08:00",IsDeleted:!1,Actived:"2019-11-26T14:36:20.277+08:00",Expired:"2019-11-26T14:36:20.277+08:00",LastName:"李想",FirstName:"",Code:"12131248",Type:"Job",Description:"",IsBlocked:!1,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5316,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"222222222222",KeypadID:121212,BadgeTechnologyID:0,Created:"2019-11-26T14:36:30.987+08:00",Modified:"2019-11-26T14:36:30.987+08:00",Expire:"2019-11-26T14:36:30.987+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:648,Modified:"2019-11-27T10:20:21.403+08:00",IsDeleted:!1,Actived:"2019-11-27T10:20:41.103+08:00",Expired:"2019-11-27T10:20:41.103+08:00",LastName:"张三",FirstName:"",Code:"12131249",Type:"Job",Description:"",IsBlocked:!1,Role:{EntityId:1,Name:"角色1",DisplayName:"测试角色1",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-10-13T17:40:59.533+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5317,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"203233010111",KeypadID:0,BadgeTechnologyID:0,Created:"2019-12-02T17:00:13.837+08:00",Modified:"2019-12-02T16:59:54.56+08:00",Expire:"2019-12-02T17:00:13.837+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:649,Modified:"2019-11-28T09:46:25.933+08:00",IsDeleted:!1,Actived:"2019-11-28T09:46:40.85+08:00",Expired:"2019-11-28T09:46:40.85+08:00",LastName:"胡二",FirstName:"",Code:"12131259",Type:"Job",Description:"",IsBlocked:!1,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[{EntityId:5318,IsDeleted:!1,Enable:!0,StampedId:0,Encoded:"111111111111",KeypadID:111111,BadgeTechnologyID:0,Created:"2019-11-28T10:01:10.003+08:00",Modified:"2019-11-28T10:01:10.003+08:00",Expire:"2019-11-28T10:01:10.003+08:00",BadgeLayoutID:4,TimeSheetType:"staff"}]},{EntityId:650,Modified:"2019-11-12T09:42:48.49+08:00",IsDeleted:!1,Actived:"2019-10-13T19:24:54.173+08:00",Expired:"2019-10-13T19:24:54.173+08:00",LastName:"胡三",FirstName:"",Code:"12131251",Type:"Job",Description:null,IsBlocked:!1,Role:{EntityId:85,Name:"角色85",DisplayName:"测试角色85",Created:"2019-10-14T13:53:30.483+08:00",Updated:"2019-10-14T13:53:30.483+08:00"},Department:{EntityId:1,Name:"WMC",DisplayName:"弱电维护中心",Created:"2019-09-24T00:00:00+08:00",Updated:"2019-09-24T00:00:00+08:00"},Badges:[]}],n=[{title:"门禁卡号",dataIndex:"Encoded",align:"center",width:40},{title:"持卡人",dataIndex:"DisplayName",align:"center",width:40},{title:"有效期",dataIndex:"Expire",align:"center",width:80},{title:"门禁卡类型",dataIndex:"TimeSheetType",align:"center",width:40},{title:"描述",dataIndex:"Description",align:"center",width:40},{title:"状态",dataIndex:"Enable",align:"center",width:40,scopedSlots:{customRender:"enable"}},{title:"操 作",align:"center",width:40,scopedSlots:{customRender:"operation"}}],l={name:"card-manage",components:{AFormItem:a("SWcn").a},data:function(){var e=this;return{modal:"",isShowModal:!1,okButton:"",modalTitle:"",confirmLoading:!1,enableEdit:!1,modalForm:{Encoded:"",DisplayName:"",DisplayExpire:"",TimeSheetType:"",Description:"",Enable:""},columns:n,expandAllRows:!0,pagination:{current:1,defaultCurrent:1,defaultPageSize:20,total:0,size:"large",onChange:function(t){return e.changePage(t)}},loading:!1,tableData:[],tableList:[],filterList:[],badgeCode:"",cardholder:""}},beforeCreate:function(){this.form=this.$form.createForm(this,{name:"advanced_search"})},created:function(){},beforeMount:function(){},mounted:function(){this.initTable()},methods:{initTable:function(){var e=this;e.loading=!0,e.form.validateFields(function(t,a){t||e.$http.get(e.$api.getCards).then(function(t){e.tableData=t.data.value,0==e.tableData.length&&(e.tableData=o),console.log(e.tableData);for(var a=0;a<e.tableData.length;a++){var d=e.tableData[a],i="",n="",l="",s="",r=d.Description,m="";d.Badges.length>0&&(i=d.Badges[0].Encoded,l=e.$common.timestampToTime(d.Badges[0].Expire),s=d.Badges[0].TimeSheetType,m=d.Badges[0].Enable),d.Role&&(n=d.Role.DisplayName);var c={Encoded:i,DisplayName:n,Expire:l,TimeSheetType:s,Description:r,Enable:m};e.tableList.push(c)}e.filterList=e.tableList,e.pagination.total=e.filterList.length,e.loading=!1})})},searchFor:function(){var e=this;e.filterList=e.tableList,e.filterList=e.filterList.filter(function(t){return(t.Encoded+"").indexOf(e.badgeCode)>-1}),e.filterList=e.filterList.filter(function(t){return(t.DisplayName+"").indexOf(e.cardholder)>-1}),e.pagination.total=e.filterList.length,e.pagination.current=1},changePage:function(e){this.pagination.current=e},addCard:function(){this.modalForm=i()({},{}),this.modalTitle="添加门禁卡",this.okButton="保存",this.enableEdit=!1,this.isShowModal=!0},checkCard:function(e){this.modalForm=i()({},e),this.modalTitle="查看门禁卡",this.modalForm.Enable=!0===this.modalForm.Enable?"Enable":"Disable",this.okButton="确定",this.enableEdit=!0,this.isShowModal=!0},editCard:function(e){this.modalForm=i()({},e),this.modalTitle="编辑门禁卡",this.modalForm.Enable=!0===this.modalForm.Enable?"Enable":"Disable",this.okButton="保存",this.enableEdit=!1,this.isShowModal=!0},deleteCard:function(e){var t=this;t.modal=t.Modal.confirm({title:"删除门禁卡",cancelText:"取消",centered:!0,closable:!1,content:"此操作将在列表删除此条数据，是否继续？",okType:"warning",onOk:function(e){var a={EntityId:t.modalForm.EntityId};t.$http.post(t.$api.deleteUser,a).then(function(e){if(200!==e.status)return!1;"success"===e.data&&t.$info({title:"完成",content:"已删除此条数据！",onOk:function(){t.modal.destroy()}}),t.modal.destroy()})},onCancel:function(e){t.modal.destroy()}})},handleOk:function(e){var t=this,a=null;if(t.confirmLoading=!0,"添加门禁卡"===t.modalTitle){var d=t.modalForm.Encoded,i=t.modalForm.DisplayName,o=(t.modalForm.Expire,t.modalForm.TimeSheetType),n=t.modalForm.Description;t.modalForm.Enable;a={Modified:new Date,IsDeleted:!1,Actived:new Date,Expired:new Date,Type:o,FirstName:"",LastName:i,Description:n,IsBlocked:!1,Code:d,Role:"",Department:""},console.log(a),t.$http.post(t.$api.getCards,a).then(function(e){console.log(e),"success"===e.data?t.$info({title:"提示",content:"添加成功！",onOk:function(){t.isShowModal=!1}}):t.$info({title:"错误",content:"发生了一些错误："+e.data.Message,onOk:function(){t.isShowModal=!1}}),t.confirmLoading=!1})}else"查看门禁卡"===t.modalTitle?(t.isShowModal=!1,t.confirmLoading=!1):"编辑门禁卡"===t.modalTitle&&(console.log(t.modalForm),t.$http.post(t.$api.updateUsers,a).then(function(e){"success"===e.data?t.$info({title:"提示",content:"修改成功！",onOk:function(){t.isShowModal=!1}}):t.$info({title:"错误",content:"发生了一些错误："+e.data.Message,onOk:function(){t.isShowModal=!1}}),t.confirmLoading=!1}))},closeModal:function(e){this.confirmLoading=!1,this.isShowModal=!1},changeTime:function(e,t){console.log(e,t)}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-manage"},[a("div",{staticClass:"search-condition"},[a("a-form",{attrs:{layout:"inline",form:e.form}},[a("a-form-item",{attrs:{label:"门禁卡号"}},[a("a-input",{attrs:{placeholder:"门禁卡号"},model:{value:e.badgeCode,callback:function(t){e.badgeCode=t},expression:"badgeCode"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"持卡人"}},[a("a-input",{attrs:{placeholder:"持卡人"},model:{value:e.cardholder,callback:function(t){e.cardholder=t},expression:"cardholder"}})],1),e._v(" "),a("a-form-item",[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.searchFor}},[e._v("搜索")])],1),e._v(" "),a("a-form-item",[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.addCard}},[e._v("添加")])],1)],1)],1),e._v(" "),a("div",{staticClass:"modal"},[a("a-modal",{attrs:{width:"800px",visible:e.isShowModal,okText:e.okButton,centered:"",destroyOnClose:"",title:e.modalTitle,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.closeModal}},[a("div",{staticClass:"form-in-modal"},[a("a-form",{attrs:{form:e.modalForm}},[a("div",{staticClass:"modal-form"},[a("div",{staticClass:"modal-form-one",staticStyle:{width:"50%"}},[a("a-form-item",{attrs:{label:"门禁卡号","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Encoded,callback:function(t){e.$set(e.modalForm,"Encoded",t)},expression:"modalForm.Encoded"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"门禁卡类型","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.TimeSheetType,callback:function(t){e.$set(e.modalForm,"TimeSheetType",t)},expression:"modalForm.TimeSheetType"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"状态","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-select",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Enable,callback:function(t){e.$set(e.modalForm,"Enable",t)},expression:"modalForm.Enable"}},[a("a-select-option",{attrs:{value:"Enable"}},[e._v("启用")]),e._v(" "),a("a-select-option",{attrs:{value:"Disable"}},[e._v("未启用")])],1)],1)],1),e._v(" "),a("div",{staticClass:"modal-form-two",staticStyle:{width:"50%"}},[a("a-form-item",{attrs:{label:"持卡人","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.DisplayName,callback:function(t){e.$set(e.modalForm,"DisplayName",t)},expression:"modalForm.DisplayName"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"有效期","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Expire,callback:function(t){e.$set(e.modalForm,"Expire",t)},expression:"modalForm.Expire"}})],1),e._v(" "),a("a-form-item",{attrs:{label:"描述","label-col":{span:7},"wrapper-col":{span:15}}},[a("a-input",{attrs:{disabled:e.enableEdit},model:{value:e.modalForm.Description,callback:function(t){e.$set(e.modalForm,"Description",t)},expression:"modalForm.Description"}})],1)],1)])])],1)])],1),e._v(" "),a("div",{staticClass:"table"},[a("a-table",{attrs:{columns:e.columns,dataSource:e.filterList,pagination:e.pagination,loading:e.loading,defaultExpandAllRows:e.expandAllRows,size:"small"},scopedSlots:e._u([{key:"enable",fn:function(t){return[e._v("\n        "+e._s(t)+"\n        ")]}},{key:"operation",fn:function(t,d){return[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkCard(d)}}},[e._v("查看")]),e._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.editCard(d)}}},[e._v("编辑")]),e._v(" "),a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.deleteCard(d)}}},[e._v("删除")])]}}])})],1)])},staticRenderFns:[]};var r=a("VU/8")(l,s,!1,function(e){a("6Xs4")},"data-v-671fb840",null);t.default=r.exports}});
//# sourceMappingURL=9.f55c70b4b6233851322a.js.map